# 日志

> 《数据库系统实现》第六章系统故障对策

## 数据库系统故障两大问题

1. 系统故障发生时数据必须受到保护 —— *可恢复性* 指系统发生某些故障时数据的完整性。围绕这个问题主要总结四方面的技术点：
   - 可回复的技术基础是日志，分别称为undo、redo、undo/redo日志。
   - 不同日志形式的恢复技术
   - 避免追溯问题的检查点技术
   - 备份技术
2. 数据不能因为一些并发原因就受到破坏 —— 这一问题在后面讨论。

## 数据库系统故障模式

1. 错误数据输入
   - 约束
   - 触发器
2. 介质故障
   - RAID
   - 冷备份
   - 联机备份
3. 灾难性故障
   - 冷备份
   - 联机备份
4. 系统故障：事务状态丢失，不能保证哪些部分已经进行。最常见的原因是掉电和软件错误。解决这种故障的机制比较复杂，后续主要讨论这部分。

## 再论事务管理

事务必须原子的执行，即全做或全不错，并且在时间上看起来似乎在某个时刻一下子执行完了一样。保证事务的正确执行是事务管理器的工作，功能包括：

1. 给日志管理器发信号，使必须的信息能以“日志记录”的形式存储在日志中。
2. 保证并发执行的事务不会以引入错误的方式互相干扰。

